 25%|█████████████████████████████████▊                                                                                                     | 5/20 [00:46<02:30, 10.04s/it]Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
{'loss': 132.8344, 'grad_norm': inf, 'learning_rate': 0.0, 'epoch': 0.71}
{'loss': 150.6002, 'grad_norm': inf, 'learning_rate': 0.0, 'epoch': 1.71}
/home/zahemen/miniconda3/envs/transformer_env/lib/python3.11/site-packages/transformers/generation/utils.py:1527: UserWarning: You have modified the pretrained model configuration to control generation. This is a deprecated strategy to control generation and will be removed in v5. Please use and modify the model generation configuration (see https://huggingface.co/docs/transformers/generation_strategies#default-text-generation-configuration )
  warnings.warn(
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
                                                                                                                                                                           Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
  0%|                                                                                                                                                | 0/5 [00:00<?, ?it/s]Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
 40%|██████████████████████████████████████████████████████▍                                                                                 | 2/5 [00:04<00:07,  2.37s/it]Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
 60%|█████████████████████████████████████████████████████████████████████████████████▌                                                      | 3/5 [00:09<00:06,  3.37s/it]Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
 80%|████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                           | 4/5 [00:14<00:03,  3.90s/it]2024-12-29 08:18:01,423 [INFO] Using default tokenizer.
 50%|███████████████████████████████████████████████████████████████████                                                                   | 10/20 [05:41<08:12, 49.23s/it]Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.                                                                                      
{'eval_loss': 8.264535903930664, 'eval_rouge1': 0.0, 'eval_rouge2': 0.0, 'eval_rougeL': 0.0, 'eval_rougeLsum': 0.0, 'eval_bleu': 0.0, 'eval_meteor': 0.025830161875024005, 'eval_runtime': 27.8105, 'eval_samples_per_second': 0.719, 'eval_steps_per_second': 0.18, 'epoch': 2.36}
{'loss': 145.9231, 'grad_norm': 298.50360107421875, 'learning_rate': 6.666666666666667e-05, 'epoch': 2.71}
{'loss': 124.3798, 'grad_norm': 131.84449768066406, 'learning_rate': 9.91486549841951e-05, 'epoch': 3.71}
{'loss': 111.3335, 'grad_norm': 99.57752990722656, 'learning_rate': 9.251085678648072e-05, 'epoch': 4.71}
                                                                                                                                                                           Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
  0%|                                                                                                                                                | 0/5 [00:00<?, ?it/s]Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
 40%|██████████████████████████████████████████████████████▍                                                                                 | 2/5 [00:10<00:16,  5.45s/it]Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
 60%|█████████████████████████████████████████████████████████████████████████████████▌                                                      | 3/5 [00:30<00:22, 11.39s/it]Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
 80%|████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                           | 4/5 [00:52<00:15, 15.29s/it]2024-12-29 08:24:00,671 [INFO] Using default tokenizer.
 75%|████████████████████████████████████████████████████████████████████████████████████████████████████▌                                 | 15/20 [11:49<05:06, 61.37s/it]Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.                                                                                      
{'eval_loss': 5.557702541351318, 'eval_rouge1': 0.17112091086867146, 'eval_rouge2': 0.021822330828263153, 'eval_rougeL': 0.13268146927797578, 'eval_rougeLsum': 0.13912443943281644, 'eval_bleu': 0.0, 'eval_meteor': 0.12144993414262326, 'eval_runtime': 90.1255, 'eval_samples_per_second': 0.222, 'eval_steps_per_second': 0.055, 'epoch': 4.71}
{'loss': 96.6074, 'grad_norm': 82.61219024658203, 'learning_rate': 8.013173181896283e-05, 'epoch': 5.71}
{'loss': 86.2561, 'grad_norm': 70.50735473632812, 'learning_rate': 6.368314950360415e-05, 'epoch': 6.71}
                                                                                                                                                                           Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
  0%|                                                                                                                                                | 0/5 [00:00<?, ?it/s]Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
 40%|██████████████████████████████████████████████████████▍                                                                                 | 2/5 [00:23<00:35, 11.98s/it]Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
 60%|█████████████████████████████████████████████████████████████████████████████████▌                                                      | 3/5 [00:43<00:30, 15.31s/it]Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
 80%|████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                           | 4/5 [01:03<00:17, 17.06s/it]2024-12-29 08:30:36,361 [INFO] Using default tokenizer.
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 20/20 [18:12<00:00, 63.03s/it]Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.                                                                                      
{'eval_loss': 4.399317264556885, 'eval_rouge1': 0.22703970211455587, 'eval_rouge2': 0.07052434114054618, 'eval_rougeL': 0.18598760044877716, 'eval_rougeLsum': 0.19049442146008072, 'eval_bleu': 0.016102614887668936, 'eval_meteor': 0.1594777088068605, 'eval_runtime': 117.1332, 'eval_samples_per_second': 0.171, 'eval_steps_per_second': 0.043, 'epoch': 7.36}
{'loss': 80.5485, 'grad_norm': 84.6671371459961, 'learning_rate': 4.5386582026834906e-05, 'epoch': 7.71}
{'loss': 76.5561, 'grad_norm': 74.23458862304688, 'learning_rate': 2.771308221117309e-05, 'epoch': 8.71}
{'loss': 74.3246, 'grad_norm': 65.64852905273438, 'learning_rate': 1.3049554138967051e-05, 'epoch': 9.71}
                                                                                                                                                                           Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
  0%|                                                                                                                                                | 0/5 [00:00<?, ?it/s]Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
 40%|██████████████████████████████████████████████████████▍                                                                                 | 2/5 [00:34<00:51, 17.06s/it]Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
 60%|█████████████████████████████████████████████████████████████████████████████████▌                                                      | 3/5 [00:56<00:38, 19.14s/it]Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
 80%|████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                           | 4/5 [01:27<00:23, 23.56s/it]2024-12-29 08:37:06,165 [INFO] Using default tokenizer.
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 20/20 [20:16<00:00, 63.03s/it]/home/zahemen/miniconda3/envs/transformer_env/lib/python3.11/site-packages/transformers/modeling_utils.py:2817: UserWarning: Moving the following attributes in the config to the generation config: {'max_length': 128, 'min_length': 20, 'num_beams': 4, 'length_penalty': 0.65, 'no_repeat_ngram_size': 3}. You are seeing this warning because you've set generation parameters in the model config, as opposed to in the generation config.
  warnings.warn(                                                                                                                                                           
{'eval_loss': 4.0979204177856445, 'eval_rouge1': 0.2514493373736713, 'eval_rouge2': 0.11492634466553886, 'eval_rougeL': 0.19618299799049305, 'eval_rougeLsum': 0.21661069978591063, 'eval_bleu': 0.059689564926123616, 'eval_meteor': 0.20086199397459178, 'eval_runtime': 124.0002, 'eval_samples_per_second': 0.161, 'eval_steps_per_second': 0.04, 'epoch': 9.71}
There were missing keys in the checkpoint model loaded: ['model.encoder.embed_tokens.weight', 'model.decoder.embed_tokens.weight', 'lm_head.weight'].
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 20/20 [20:26<00:00, 61.30s/it]
{'train_runtime': 1229.7308, 'train_samples_per_second': 1.464, 'train_steps_per_second': 0.016, 'train_loss': 107.93638076782227, 'epoch': 9.71}
2024-12-29 08:37:17,336 [INFO] Training completed and model saved!
