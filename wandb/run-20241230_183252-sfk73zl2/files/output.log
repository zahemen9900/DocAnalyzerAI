 25%|███████████████████████████████████▌                                                                                                          | 5/20 [00:40<02:07,  8.48s/it]Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
{'loss': 201.54, 'grad_norm': inf, 'learning_rate': 0.0, 'epoch': 0.71}
{'loss': 224.8687, 'grad_norm': inf, 'learning_rate': 0.0, 'epoch': 1.71}
/home/zahemen/miniconda3/envs/transformer_env/lib/python3.11/site-packages/transformers/generation/utils.py:1527: UserWarning: You have modified the pretrained model configuration to control generation. This is a deprecated strategy to control generation and will be removed in v5. Please use and modify the model generation configuration (see https://huggingface.co/docs/transformers/generation_strategies#default-text-generation-configuration )
  warnings.warn(
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
                                                                                                                                                                                  Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
  0%|                                                                                                                                                       | 0/5 [00:00<?, ?it/s]Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
 40%|█████████████████████████████████████████████████████████▏                                                                                     | 2/5 [00:04<00:07,  2.48s/it]Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
 60%|█████████████████████████████████████████████████████████████████████████████████████▊                                                         | 3/5 [00:08<00:06,  3.08s/it]Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
 80%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                            | 4/5 [00:13<00:03,  3.66s/it]2024-12-30 18:33:55,916 [INFO] Using default tokenizer.
 50%|██████████████████████████████████████████████████████████████████████▌                                                                      | 10/20 [03:54<05:20, 32.06s/it]Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
                                                                                                                                                                                  2024-12-30 18:39:14,530 [INFO] Using default tokenizer.
{'eval_loss': 12.413415908813477, 'eval_rouge1': 0.004347826086956522, 'eval_rouge2': 0.0, 'eval_rougeL': 0.004347826086956522, 'eval_rougeLsum': 0.004347826086956522, 'eval_bleu': 0.0, 'eval_meteor': 0.02753664620792349, 'eval_runtime': 23.3248, 'eval_samples_per_second': 0.857, 'eval_steps_per_second': 0.214, 'epoch': 2.36}
{'loss': 224.8447, 'grad_norm': 564.6854248046875, 'learning_rate': 6.666666666666667e-05, 'epoch': 2.71}
{'loss': 183.2947, 'grad_norm': 415.5723571777344, 'learning_rate': 9.91486549841951e-05, 'epoch': 3.71}
{'loss': 123.0127, 'grad_norm': 394.62628173828125, 'learning_rate': 9.251085678648072e-05, 'epoch': 4.71}
 75%|█████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                   | 15/20 [09:22<03:51, 46.22s/it]Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.                                                                                             
{'eval_loss': 5.264664173126221, 'eval_rouge1': 0.003626255902174625, 'eval_rouge2': 0.0, 'eval_rougeL': 0.0036330365162179578, 'eval_rougeLsum': 0.003567076548133378, 'eval_bleu': 0.0, 'eval_meteor': 0.0, 'eval_runtime': 146.3347, 'eval_samples_per_second': 0.137, 'eval_steps_per_second': 0.034, 'epoch': 4.71}
{'loss': 94.6312, 'grad_norm': 331.541748046875, 'learning_rate': 8.013173181896283e-05, 'epoch': 5.71}
{'loss': 81.8233, 'grad_norm': 320.08673095703125, 'learning_rate': 6.368314950360415e-05, 'epoch': 6.71}
                                                                                                                                                                                  Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
  0%|                                                                                                                                                       | 0/5 [00:00<?, ?it/s]Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
 40%|█████████████████████████████████████████████████████████▏                                                                                     | 2/5 [00:05<00:08,  2.73s/it]Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
 60%|█████████████████████████████████████████████████████████████████████████████████████▊                                                         | 3/5 [00:11<00:08,  4.17s/it]Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
 80%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                            | 4/5 [00:18<00:05,  5.00s/it]2024-12-30 18:42:44,609 [INFO] Using default tokenizer.
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 20/20 [12:49<00:00, 39.48s/it]Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.                                                                                             
{'eval_loss': 3.8656959533691406, 'eval_rouge1': 0.2710976560376681, 'eval_rouge2': 0.07574873909084436, 'eval_rougeL': 0.2075280867177489, 'eval_rougeLsum': 0.20767187687578936, 'eval_bleu': 0.04223845054099862, 'eval_meteor': 0.24911722700382746, 'eval_runtime': 28.6582, 'eval_samples_per_second': 0.698, 'eval_steps_per_second': 0.174, 'epoch': 7.36}
{'loss': 73.0248, 'grad_norm': 317.812744140625, 'learning_rate': 4.5386582026834906e-05, 'epoch': 7.71}
{'loss': 67.3149, 'grad_norm': 307.6690673828125, 'learning_rate': 2.771308221117309e-05, 'epoch': 8.71}
{'loss': 63.6777, 'grad_norm': 306.1876220703125, 'learning_rate': 1.3049554138967051e-05, 'epoch': 9.71}
                                                                                                                                                                                  Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
  0%|                                                                                                                                                       | 0/5 [00:00<?, ?it/s]Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
 40%|█████████████████████████████████████████████████████████▏                                                                                     | 2/5 [00:04<00:07,  2.42s/it]Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
 60%|█████████████████████████████████████████████████████████████████████████████████████▊                                                         | 3/5 [00:11<00:08,  4.00s/it]Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
 80%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                            | 4/5 [00:17<00:04,  4.92s/it]2024-12-30 18:46:16,073 [INFO] Using default tokenizer.
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 20/20 [13:22<00:00, 39.48s/it]/home/zahemen/miniconda3/envs/transformer_env/lib/python3.11/site-packages/transformers/modeling_utils.py:2817: UserWarning: Moving the following attributes in the config to the generation config: {'max_length': 128, 'min_length': 20, 'num_beams': 4, 'length_penalty': 0.65, 'no_repeat_ngram_size': 3}. You are seeing this warning because you've set generation parameters in the model config, as opposed to in the generation config.
  warnings.warn(                                                                                                                                                                  
{'eval_loss': 3.37050199508667, 'eval_rouge1': 0.2443784292990529, 'eval_rouge2': 0.08473717922283726, 'eval_rougeL': 0.21560336001125477, 'eval_rougeLsum': 0.21695486640423714, 'eval_bleu': 0.04204641204324784, 'eval_meteor': 0.23866238571395076, 'eval_runtime': 33.3395, 'eval_samples_per_second': 0.6, 'eval_steps_per_second': 0.15, 'epoch': 9.71}
There were missing keys in the checkpoint model loaded: ['model.encoder.embed_tokens.weight', 'model.decoder.embed_tokens.weight', 'lm_head.weight'].
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 20/20 [13:26<00:00, 40.34s/it]
{'train_runtime': 808.7709, 'train_samples_per_second': 2.226, 'train_steps_per_second': 0.025, 'train_loss': 133.80328140258788, 'epoch': 9.71}
2024-12-30 18:46:21,711 [INFO] Training completed and model saved!
