  1%|██                                                                                                                                          | 10/675 [00:41<45:28,  4.10s/it]Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
                                                                                                                                                                                  2024-12-30 23:40:37,336 [ERROR] Metrics computation failed: argument 'ids': 'list' object cannot be interpreted as an integer
Traceback (most recent call last):████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 40/40 [01:44<00:00,  6.59s/it]
  File "/home/zahemen/projects/dl-lib/DocAnalyzerAI/src/train_finbot_qlora.py", line 57, in __call__
    predictions = self.tokenizer.batch_decode(predictions, skip_special_tokens=True)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/zahemen/miniconda3/envs/transformer_env/lib/python3.11/site-packages/transformers/tokenization_utils_base.py", line 3803, in batch_decode
    return [
           ^
  File "/home/zahemen/miniconda3/envs/transformer_env/lib/python3.11/site-packages/transformers/tokenization_utils_base.py", line 3804, in <listcomp>
    self.decode(
  File "/home/zahemen/miniconda3/envs/transformer_env/lib/python3.11/site-packages/transformers/tokenization_utils_base.py", line 3843, in decode
    return self._decode(
           ^^^^^^^^^^^^^
  File "/home/zahemen/miniconda3/envs/transformer_env/lib/python3.11/site-packages/transformers/tokenization_utils_fast.py", line 655, in _decode
    text = self._tokenizer.decode(token_ids, skip_special_tokens=skip_special_tokens)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: argument 'ids': 'list' object cannot be interpreted as an integer
  3%|████▏                                                                                                                                       | 20/675 [03:13<57:16,  5.25s/it]Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.                                                                                             
{'eval_loss': 11.419790267944336, 'eval_rouge1': 0.0, 'eval_rouge2': 0.0, 'eval_rougeL': 0.0, 'eval_bleu': 0.0, 'eval_meteor': 0.0, 'eval_runtime': 110.812, 'eval_samples_per_second': 1.444, 'eval_steps_per_second': 0.361, 'epoch': 0.22}
{'loss': 91.4088, 'grad_norm': 26.613903045654297, 'learning_rate': 2.9411764705882354e-05, 'epoch': 0.44}
                                                                                                                                                                                  2024-12-30 23:43:00,998 [ERROR] Metrics computation failed: argument 'ids': 'list' object cannot be interpreted as an integer
Traceback (most recent call last):████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 40/40 [01:36<00:00,  6.23s/it]
  File "/home/zahemen/projects/dl-lib/DocAnalyzerAI/src/train_finbot_qlora.py", line 57, in __call__
    predictions = self.tokenizer.batch_decode(predictions, skip_special_tokens=True)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/zahemen/miniconda3/envs/transformer_env/lib/python3.11/site-packages/transformers/tokenization_utils_base.py", line 3803, in batch_decode
    return [
           ^
  File "/home/zahemen/miniconda3/envs/transformer_env/lib/python3.11/site-packages/transformers/tokenization_utils_base.py", line 3804, in <listcomp>
    self.decode(
  File "/home/zahemen/miniconda3/envs/transformer_env/lib/python3.11/site-packages/transformers/tokenization_utils_base.py", line 3843, in decode
    return self._decode(
           ^^^^^^^^^^^^^
  File "/home/zahemen/miniconda3/envs/transformer_env/lib/python3.11/site-packages/transformers/tokenization_utils_fast.py", line 655, in _decode
    text = self._tokenizer.decode(token_ids, skip_special_tokens=skip_special_tokens)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: argument 'ids': 'list' object cannot be interpreted as an integer
  4%|██████▏                                                                                                                                     | 30/675 [05:35<55:17,  5.14s/it]Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.                                                                                             
{'eval_loss': 11.012289047241211, 'eval_rouge1': 0.0, 'eval_rouge2': 0.0, 'eval_rougeL': 0.0, 'eval_bleu': 0.0, 'eval_meteor': 0.0, 'eval_runtime': 102.3701, 'eval_samples_per_second': 1.563, 'eval_steps_per_second': 0.391, 'epoch': 0.44}
                                                                                                                                                                                  2024-12-30 23:45:24,366 [ERROR] Metrics computation failed: argument 'ids': 'list' object cannot be interpreted as an integer
Traceback (most recent call last):████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 40/40 [01:36<00:00,  6.48s/it]
  File "/home/zahemen/projects/dl-lib/DocAnalyzerAI/src/train_finbot_qlora.py", line 57, in __call__
    predictions = self.tokenizer.batch_decode(predictions, skip_special_tokens=True)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/zahemen/miniconda3/envs/transformer_env/lib/python3.11/site-packages/transformers/tokenization_utils_base.py", line 3803, in batch_decode
    return [
           ^
  File "/home/zahemen/miniconda3/envs/transformer_env/lib/python3.11/site-packages/transformers/tokenization_utils_base.py", line 3804, in <listcomp>
    self.decode(
  File "/home/zahemen/miniconda3/envs/transformer_env/lib/python3.11/site-packages/transformers/tokenization_utils_base.py", line 3843, in decode
    return self._decode(
           ^^^^^^^^^^^^^
  File "/home/zahemen/miniconda3/envs/transformer_env/lib/python3.11/site-packages/transformers/tokenization_utils_fast.py", line 655, in _decode
    text = self._tokenizer.decode(token_ids, skip_special_tokens=skip_special_tokens)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: argument 'ids': 'list' object cannot be interpreted as an integer
  6%|████████▎                                                                                                                                   | 40/675 [08:01<57:58,  5.48s/it]Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.                                                                                             
{'eval_loss': 10.223902702331543, 'eval_rouge1': 0.0, 'eval_rouge2': 0.0, 'eval_rougeL': 0.0, 'eval_bleu': 0.0, 'eval_meteor': 0.0, 'eval_runtime': 103.2606, 'eval_samples_per_second': 1.549, 'eval_steps_per_second': 0.387, 'epoch': 0.67}
{'loss': 84.2286, 'grad_norm': 38.44121551513672, 'learning_rate': 5.882352941176471e-05, 'epoch': 0.89}
                                                                                                                                                                                  2024-12-30 23:47:54,247 [ERROR] Metrics computation failed: argument 'ids': 'list' object cannot be interpreted as an integer
Traceback (most recent call last):████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 40/40 [01:40<00:00,  6.78s/it]
  File "/home/zahemen/projects/dl-lib/DocAnalyzerAI/src/train_finbot_qlora.py", line 57, in __call__
    predictions = self.tokenizer.batch_decode(predictions, skip_special_tokens=True)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/zahemen/miniconda3/envs/transformer_env/lib/python3.11/site-packages/transformers/tokenization_utils_base.py", line 3803, in batch_decode
    return [
           ^
  File "/home/zahemen/miniconda3/envs/transformer_env/lib/python3.11/site-packages/transformers/tokenization_utils_base.py", line 3804, in <listcomp>
    self.decode(
  File "/home/zahemen/miniconda3/envs/transformer_env/lib/python3.11/site-packages/transformers/tokenization_utils_base.py", line 3843, in decode
    return self._decode(
           ^^^^^^^^^^^^^
  File "/home/zahemen/miniconda3/envs/transformer_env/lib/python3.11/site-packages/transformers/tokenization_utils_fast.py", line 655, in _decode
    text = self._tokenizer.decode(token_ids, skip_special_tokens=skip_special_tokens)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: argument 'ids': 'list' object cannot be interpreted as an integer
  7%|██████████▎                                                                                                                                 | 50/675 [10:35<55:58,  5.37s/it]Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.                                                                                             
{'eval_loss': 9.029497146606445, 'eval_rouge1': 0.0, 'eval_rouge2': 0.0, 'eval_rougeL': 0.0, 'eval_bleu': 0.0, 'eval_meteor': 0.0, 'eval_runtime': 107.4281, 'eval_samples_per_second': 1.489, 'eval_steps_per_second': 0.372, 'epoch': 0.89}
                                                                                                                                                                                  2024-12-30 23:50:26,341 [ERROR] Metrics computation failed: argument 'ids': 'list' object cannot be interpreted as an integer
Traceback (most recent call last):████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 40/40 [01:37<00:00,  5.73s/it]
  File "/home/zahemen/projects/dl-lib/DocAnalyzerAI/src/train_finbot_qlora.py", line 57, in __call__
    predictions = self.tokenizer.batch_decode(predictions, skip_special_tokens=True)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/zahemen/miniconda3/envs/transformer_env/lib/python3.11/site-packages/transformers/tokenization_utils_base.py", line 3803, in batch_decode
    return [
           ^
  File "/home/zahemen/miniconda3/envs/transformer_env/lib/python3.11/site-packages/transformers/tokenization_utils_base.py", line 3804, in <listcomp>
    self.decode(
  File "/home/zahemen/miniconda3/envs/transformer_env/lib/python3.11/site-packages/transformers/tokenization_utils_base.py", line 3843, in decode
    return self._decode(
           ^^^^^^^^^^^^^
  File "/home/zahemen/miniconda3/envs/transformer_env/lib/python3.11/site-packages/transformers/tokenization_utils_fast.py", line 655, in _decode
    text = self._tokenizer.decode(token_ids, skip_special_tokens=skip_special_tokens)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: argument 'ids': 'list' object cannot be interpreted as an integer
  9%|████████████▍                                                                                                                               | 60/675 [13:02<58:52,  5.74s/it]Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.                                                                                             
{'eval_loss': 7.0070390701293945, 'eval_rouge1': 0.0, 'eval_rouge2': 0.0, 'eval_rougeL': 0.0, 'eval_bleu': 0.0, 'eval_meteor': 0.0, 'eval_runtime': 105.742, 'eval_samples_per_second': 1.513, 'eval_steps_per_second': 0.378, 'epoch': 1.11}
{'loss': 61.1972, 'grad_norm': 30.156015396118164, 'learning_rate': 8.676470588235295e-05, 'epoch': 1.33}
                                                                                                                                                                                  2024-12-30 23:52:59,103 [ERROR] Metrics computation failed: argument 'ids': 'list' object cannot be interpreted as an integer
Traceback (most recent call last):████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 40/40 [01:45<00:00,  5.63s/it]
  File "/home/zahemen/projects/dl-lib/DocAnalyzerAI/src/train_finbot_qlora.py", line 57, in __call__
    predictions = self.tokenizer.batch_decode(predictions, skip_special_tokens=True)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/zahemen/miniconda3/envs/transformer_env/lib/python3.11/site-packages/transformers/tokenization_utils_base.py", line 3803, in batch_decode
    return [
           ^
  File "/home/zahemen/miniconda3/envs/transformer_env/lib/python3.11/site-packages/transformers/tokenization_utils_base.py", line 3804, in <listcomp>
    self.decode(
  File "/home/zahemen/miniconda3/envs/transformer_env/lib/python3.11/site-packages/transformers/tokenization_utils_base.py", line 3843, in decode
    return self._decode(
           ^^^^^^^^^^^^^
  File "/home/zahemen/miniconda3/envs/transformer_env/lib/python3.11/site-packages/transformers/tokenization_utils_fast.py", line 655, in _decode
    text = self._tokenizer.decode(token_ids, skip_special_tokens=skip_special_tokens)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: argument 'ids': 'list' object cannot be interpreted as an integer
 10%|██████████████▌                                                                                                                             | 70/675 [15:22<44:21,  4.40s/it]Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.                                                                                             
{'eval_loss': 4.978700637817383, 'eval_rouge1': 0.0, 'eval_rouge2': 0.0, 'eval_rougeL': 0.0, 'eval_bleu': 0.0, 'eval_meteor': 0.0, 'eval_runtime': 111.0262, 'eval_samples_per_second': 1.441, 'eval_steps_per_second': 0.36, 'epoch': 1.33}

 85%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                     | 34/40 [00:56<00:31,  5.27s/it]
