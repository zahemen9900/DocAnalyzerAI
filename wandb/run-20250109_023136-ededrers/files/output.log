  0%|                                                                                                                                     | 0/70 [00:00<?, ?it/s]
{'train_runtime': 1.8272, 'train_samples_per_second': 2681.675, 'train_steps_per_second': 38.31, 'train_loss': 0.0, 'epoch': 9.03}
2025-01-09 02:31:37,818 [INFO] Saving LoRA adapter...
2025-01-09 02:31:38,290 [INFO] Merging LoRA weights...
/home/zahemen/miniconda3/envs/transformer_LM/lib/python3.11/site-packages/peft/tuners/lora/bnb.py:355: UserWarning: Merge lora module to 4-bit linear may get different generations due to rounding errors.
  warnings.warn(
/home/zahemen/miniconda3/envs/transformer_LM/lib/python3.11/site-packages/transformers/modeling_utils.py:2618: UserWarning: Moving the following attributes in the config to the generation config: {'max_length': 60, 'min_length': 20, 'num_beams': 10, 'length_penalty': 0.65, 'no_repeat_ngram_size': 3}. You are seeing this warning because you've set generation parameters in the model config, as opposed to in the generation config.
  warnings.warn(
2025-01-09 02:31:38,821 [INFO] Exporting to ONNX format...
2025-01-09 02:31:38,905 [INFO] Exporting model to ONNX format...
2025-01-09 02:31:38,906 [ERROR] Failed to export model to ONNX: 'BlenderbotConfig' object has no attribute 'is_torch_support_available'
Traceback (most recent call last):
  File "/home/zahemen/projects/dl-lib/DocAnalyzerAI/src/main/train_finbot_qlora.py", line 153, in export_to_onnx
    export(
  File "/home/zahemen/miniconda3/envs/transformer_LM/lib/python3.11/site-packages/transformers/onnx/convert.py", line 305, in export
    if not config.is_torch_support_available:
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/zahemen/miniconda3/envs/transformer_LM/lib/python3.11/site-packages/transformers/configuration_utils.py", line 202, in __getattribute__
    return super().__getattribute__(key)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'BlenderbotConfig' object has no attribute 'is_torch_support_available'
2025-01-09 02:31:38,907 [ERROR] Failed to save model
Traceback (most recent call last):
  File "/home/zahemen/projects/dl-lib/DocAnalyzerAI/src/main/train_finbot_qlora.py", line 421, in train
    export_to_onnx(merged_model, tokenizer, output_dir)
  File "/home/zahemen/projects/dl-lib/DocAnalyzerAI/src/main/train_finbot_qlora.py", line 153, in export_to_onnx
    export(
  File "/home/zahemen/miniconda3/envs/transformer_LM/lib/python3.11/site-packages/transformers/onnx/convert.py", line 305, in export
    if not config.is_torch_support_available:
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/zahemen/miniconda3/envs/transformer_LM/lib/python3.11/site-packages/transformers/configuration_utils.py", line 202, in __getattribute__
    return super().__getattribute__(key)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'BlenderbotConfig' object has no attribute 'is_torch_support_available'
2025-01-09 02:31:38,907 [ERROR] Training failed: 'BlenderbotConfig' object has no attribute 'is_torch_support_available'
Traceback (most recent call last):
  File "/home/zahemen/projects/dl-lib/DocAnalyzerAI/src/main/train_finbot_qlora.py", line 421, in train
    export_to_onnx(merged_model, tokenizer, output_dir)
  File "/home/zahemen/projects/dl-lib/DocAnalyzerAI/src/main/train_finbot_qlora.py", line 153, in export_to_onnx
    export(
  File "/home/zahemen/miniconda3/envs/transformer_LM/lib/python3.11/site-packages/transformers/onnx/convert.py", line 305, in export
    if not config.is_torch_support_available:
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/zahemen/miniconda3/envs/transformer_LM/lib/python3.11/site-packages/transformers/configuration_utils.py", line 202, in __getattribute__
    return super().__getattribute__(key)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'BlenderbotConfig' object has no attribute 'is_torch_support_available'
2025-01-09 02:31:39,055 [ERROR] Script failed: 'BlenderbotConfig' object has no attribute 'is_torch_support_available'
Traceback (most recent call last):
  File "/home/zahemen/projects/dl-lib/DocAnalyzerAI/src/main/train_finbot_qlora.py", line 449, in <module>
    train()
  File "/home/zahemen/projects/dl-lib/DocAnalyzerAI/src/main/train_finbot_qlora.py", line 421, in train
    export_to_onnx(merged_model, tokenizer, output_dir)
  File "/home/zahemen/projects/dl-lib/DocAnalyzerAI/src/main/train_finbot_qlora.py", line 153, in export_to_onnx
    export(
  File "/home/zahemen/miniconda3/envs/transformer_LM/lib/python3.11/site-packages/transformers/onnx/convert.py", line 305, in export
    if not config.is_torch_support_available:
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/zahemen/miniconda3/envs/transformer_LM/lib/python3.11/site-packages/transformers/configuration_utils.py", line 202, in __getattribute__
    return super().__getattribute__(key)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'BlenderbotConfig' object has no attribute 'is_torch_support_available'
Traceback (most recent call last):
  File "/home/zahemen/projects/dl-lib/DocAnalyzerAI/src/main/train_finbot_qlora.py", line 449, in <module>
    train()
  File "/home/zahemen/projects/dl-lib/DocAnalyzerAI/src/main/train_finbot_qlora.py", line 421, in train
    export_to_onnx(merged_model, tokenizer, output_dir)
  File "/home/zahemen/projects/dl-lib/DocAnalyzerAI/src/main/train_finbot_qlora.py", line 153, in export_to_onnx
    export(
  File "/home/zahemen/miniconda3/envs/transformer_LM/lib/python3.11/site-packages/transformers/onnx/convert.py", line 305, in export
    if not config.is_torch_support_available:
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/zahemen/miniconda3/envs/transformer_LM/lib/python3.11/site-packages/transformers/configuration_utils.py", line 202, in __getattribute__
    return super().__getattribute__(key)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'BlenderbotConfig' object has no attribute 'is_torch_support_available'
[rank0]: Traceback (most recent call last):
[rank0]:   File "/home/zahemen/projects/dl-lib/DocAnalyzerAI/src/main/train_finbot_qlora.py", line 449, in <module>
[rank0]:     train()
[rank0]:   File "/home/zahemen/projects/dl-lib/DocAnalyzerAI/src/main/train_finbot_qlora.py", line 421, in train
[rank0]:     export_to_onnx(merged_model, tokenizer, output_dir)
[rank0]:   File "/home/zahemen/projects/dl-lib/DocAnalyzerAI/src/main/train_finbot_qlora.py", line 153, in export_to_onnx
[rank0]:     export(
[rank0]:   File "/home/zahemen/miniconda3/envs/transformer_LM/lib/python3.11/site-packages/transformers/onnx/convert.py", line 305, in export
[rank0]:     if not config.is_torch_support_available:
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/zahemen/miniconda3/envs/transformer_LM/lib/python3.11/site-packages/transformers/configuration_utils.py", line 202, in __getattribute__
[rank0]:     return super().__getattribute__(key)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]: AttributeError: 'BlenderbotConfig' object has no attribute 'is_torch_support_available'
